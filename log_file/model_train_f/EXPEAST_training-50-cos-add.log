Running command: python ../common_train.py --dataset EXPEAST --model Onion_PI_uptime --randomnumseed 42  --device_num 0
with_PI: True /n
addloss: False /n
../../onion_train_data/train_results_EAST/EXPEAST_42_Onion_PI_uptime
start train
加载验证集耗时: 0.31 min
max_n: 92, max_r: 50, max_z: 75
epoch: 0
Training:   0%|                                                                                                                                                                                                                                                                        | 0/119 [00:00<?, ?it/s]Training:   1%|██▏                                                                                                                                                                                                                                                             | 1/119 [00:02<04:59,  2.53s/it]Training:   2%|████▎                                                                                                                                                                                                                                                           | 2/119 [00:03<03:40,  1.89s/it]Training:   3%|██████▍                                                                                                                                                                                                                                                         | 3/119 [00:05<03:07,  1.62s/it]Training:   3%|████████▌                                                                                                                                                                                                                                                       | 4/119 [00:06<03:00,  1.57s/it]Training:   4%|██████████▊                                                                                                                                                                                                                                                     | 5/119 [00:08<02:46,  1.46s/it]Training:   5%|████████████▉                                                                                                                                                                                                                                                   | 6/119 [00:09<02:36,  1.39s/it]Training:   6%|███████████████                                                                                                                                                                                                                                                 | 7/119 [00:10<02:31,  1.36s/it]Training:   7%|█████████████████▏                                                                                                                                                                                                                                              | 8/119 [00:11<02:28,  1.34s/it]Training:   8%|███████████████████▎                                                                                                                                                                                                                                            | 9/119 [00:13<02:28,  1.35s/it]Training:   8%|█████████████████████▍                                                                                                                                                                                                                                         | 10/119 [00:14<02:26,  1.34s/it]Training:   9%|███████████████████████▌                                                                                                                                                                                                                                       | 11/119 [00:15<02:23,  1.33s/it]Training:  10%|█████████████████████████▋                                                                                                                                                                                                                                     | 12/119 [00:17<02:21,  1.32s/it]Training:  11%|███████████████████████████▊                                                                                                                                                                                                                                   | 13/119 [00:18<02:19,  1.31s/it]Training:  12%|██████████████████████████████                                                                                                                                                                                                                                 | 14/119 [00:19<02:20,  1.34s/it]Training:  13%|████████████████████████████████▏                                                                                                                                                                                                                              | 15/119 [00:21<02:21,  1.36s/it]Training:  13%|██████████████████████████████████▎                                                                                                                                                                                                                            | 16/119 [00:22<02:21,  1.37s/it]Training:  14%|████████████████████████████████████▍                                                                                                                                                                                                                          | 17/119 [00:24<02:19,  1.37s/it]Training:  15%|██████████████████████████████████████▌                                                                                                                                                                                                                        | 18/119 [00:25<02:17,  1.36s/it]Training:  16%|████████████████████████████████████████▋                                                                                                                                                                                                                      | 19/119 [00:26<02:17,  1.37s/it]Training:  17%|██████████████████████████████████████████▊                                                                                                                                                                                                                    | 20/119 [00:28<02:16,  1.38s/it]Training:  18%|█████████████████████████████████████████████                                                                                                                                                                                                                  | 21/119 [00:29<02:15,  1.39s/it]Training:  18%|███████████████████████████████████████████████▏                                                                                                                                                                                                               | 22/119 [00:30<02:14,  1.39s/it]Training:  19%|█████████████████████████████████████████████████▎                                                                                                                                                                                                             | 23/119 [00:32<02:11,  1.37s/it]Training:  20%|███████████████████████████████████████████████████▍                                                                                                                                                                                                           | 24/119 [00:33<02:10,  1.37s/it]Training:  21%|█████████████████████████████████████████████████████▌                                                                                                                                                                                                         | 25/119 [00:35<02:09,  1.38s/it]Training:  22%|███████████████████████████████████████████████████████▋                                                                                                                                                                                                       | 26/119 [00:36<02:09,  1.39s/it]Training:  23%|█████████████████████████████████████████████████████████▊                                                                                                                                                                                                     | 27/119 [00:37<02:05,  1.36s/it]Training:  24%|████████████████████████████████████████████████████████████                                                                                                                                                                                                   | 28/119 [00:39<02:02,  1.34s/it]Training:  24%|██████████████████████████████████████████████████████████████▏                                                                                                                                                                                                | 29/119 [00:40<02:01,  1.35s/it]Training:  25%|████████████████████████████████████████████████████████████████▎                                                                                                                                                                                              | 30/119 [00:41<01:59,  1.34s/it]Training:  26%|██████████████████████████████████████████████████████████████████▍                                                                                                                                                                                            | 31/119 [00:43<01:56,  1.33s/it]Training:  27%|████████████████████████████████████████████████████████████████████▌                                                                                                                                                                                          | 32/119 [00:44<01:54,  1.32s/it]Training:  28%|██████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                        | 33/119 [00:45<01:52,  1.31s/it]Training:  29%|████████████████████████████████████████████████████████████████████████▊                                                                                                                                                                                      | 34/119 [00:46<01:51,  1.31s/it]Training:  29%|███████████████████████████████████████████████████████████████████████████                                                                                                                                                                                    | 35/119 [00:48<01:54,  1.37s/it]Training:  30%|█████████████████████████████████████████████████████████████████████████████▏                                                                                                                                                                                 | 36/119 [00:49<01:53,  1.37s/it]Training:  31%|███████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                                               | 37/119 [00:51<01:53,  1.38s/it]Training:  32%|█████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                                                             | 38/119 [00:52<01:50,  1.36s/it]Training:  33%|███████████████████████████████████████████████████████████████████████████████████▌                                                                                                                                                                           | 39/119 [00:53<01:48,  1.36s/it]Training:  34%|█████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                         | 40/119 [00:55<01:47,  1.36s/it]Training:  34%|███████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                                                                       | 41/119 [00:56<01:44,  1.34s/it]Training:  35%|██████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                                     | 42/119 [00:57<01:42,  1.33s/it]Training:  36%|████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                                                                  | 43/119 [00:59<01:40,  1.32s/it]Training:  37%|██████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                                | 44/119 [01:00<01:38,  1.31s/it]Training:  38%|████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                                              | 45/119 [01:01<01:34,  1.28s/it]Training:  39%|██████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                                                            | 46/119 [01:02<01:31,  1.25s/it]Training:  39%|████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                          | 47/119 [01:04<01:30,  1.26s/it]Training:  40%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                                                        | 48/119 [01:05<01:30,  1.27s/it]Training:  41%|█████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                      | 49/119 [01:06<01:27,  1.26s/it]Training:  42%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                                                   | 50/119 [01:07<01:25,  1.24s/it]Training:  43%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                 | 51/119 [01:09<01:23,  1.23s/it]Training:  44%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                               | 52/119 [01:10<01:21,  1.22s/it]Training:  45%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                                             | 53/119 [01:11<01:20,  1.21s/it]Training:  45%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                           | 54/119 [01:12<01:18,  1.21s/it]Training:  46%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                                         | 55/119 [01:13<01:18,  1.22s/it]Training:  47%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                       | 56/119 [01:15<01:19,  1.26s/it]Training:  48%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                                    | 57/119 [01:16<01:18,  1.27s/it]Training:  49%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                  | 58/119 [01:17<01:16,  1.26s/it]Training:  50%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                | 59/119 [01:19<01:15,  1.26s/it]Training:  50%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                              | 60/119 [01:20<01:15,  1.27s/it]Training:  51%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                            | 61/119 [01:21<01:14,  1.28s/it]Training:  52%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                          | 62/119 [01:22<01:11,  1.26s/it]Training:  53%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                        | 63/119 [01:24<01:11,  1.27s/it]Training:  54%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                     | 64/119 [01:25<01:09,  1.27s/it]Training:  55%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                   | 65/119 [01:26<01:08,  1.26s/it]Training:  55%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                 | 66/119 [01:27<01:06,  1.26s/it]Training:  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                               | 67/119 [01:29<01:05,  1.25s/it]Training:  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                             | 68/119 [01:30<01:03,  1.24s/it]Training:  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                           | 69/119 [01:31<01:02,  1.25s/it]Training:  59%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                         | 70/119 [01:32<01:02,  1.27s/it]Training:  60%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                      | 71/119 [01:34<01:01,  1.27s/it]Training:  61%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                    | 72/119 [01:35<01:00,  1.29s/it]Training:  61%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                  | 73/119 [01:36<00:59,  1.29s/it]Training:  62%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                | 74/119 [01:38<00:58,  1.29s/it]Training:  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                              | 75/119 [01:39<00:56,  1.29s/it]Training:  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                            | 76/119 [01:40<00:55,  1.30s/it]Training:  65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                          | 77/119 [01:42<00:54,  1.30s/it]Training:  66%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                       | 78/119 [01:43<00:52,  1.28s/it]Training:  66%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                     | 79/119 [01:44<00:50,  1.27s/it]Training:  67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                   | 80/119 [01:45<00:50,  1.28s/it]Training:  68%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                 | 81/119 [01:47<00:49,  1.29s/it]Training:  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 82/119 [01:48<00:47,  1.29s/it]Training:  70%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                             | 83/119 [01:49<00:46,  1.29s/it]Training:  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                           | 84/119 [01:51<00:46,  1.34s/it]Training:  71%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                        | 85/119 [01:52<00:46,  1.37s/it]Training:  72%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                      | 86/119 [01:54<00:44,  1.36s/it]Training:  73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 87/119 [01:55<00:43,  1.36s/it]Training:  74%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                  | 88/119 [01:56<00:42,  1.37s/it]Training:  75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                | 89/119 [01:58<00:41,  1.38s/it]Training:  76%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 90/119 [01:59<00:40,  1.39s/it]Training:  76%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                            | 91/119 [02:00<00:38,  1.36s/it]Training:  77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                         | 92/119 [02:02<00:36,  1.34s/it]Training:  78%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                       | 93/119 [02:03<00:35,  1.36s/it]Training:  79%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                     | 94/119 [02:04<00:34,  1.37s/it]Training:  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                   | 95/119 [02:06<00:33,  1.38s/it]Training:  81%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                 | 96/119 [02:07<00:31,  1.38s/it]Training:  82%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                               | 97/119 [02:09<00:30,  1.39s/it]Training:  82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                             | 98/119 [02:10<00:29,  1.41s/it]Training:  83%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                          | 99/119 [02:11<00:27,  1.40s/it]Training:  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                        | 100/119 [02:13<00:26,  1.39s/it]Training:  85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                      | 101/119 [02:14<00:25,  1.39s/it]Training:  86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                    | 102/119 [02:16<00:23,  1.40s/it]Training:  87%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                  | 103/119 [02:17<00:22,  1.39s/it]Training:  87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                | 104/119 [02:18<00:20,  1.39s/it]Training:  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                              | 105/119 [02:20<00:19,  1.40s/it]Training:  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                           | 106/119 [02:21<00:18,  1.40s/it]Training:  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                         | 107/119 [02:23<00:16,  1.37s/it]Training:  91%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                       | 108/119 [02:24<00:14,  1.35s/it]Training:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                     | 109/119 [02:25<00:13,  1.34s/it]Training:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                   | 110/119 [02:27<00:12,  1.44s/it]Training:  93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                 | 111/119 [02:28<00:11,  1.43s/it]Training:  94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████               | 112/119 [02:30<00:09,  1.40s/it]Training:  95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏            | 113/119 [02:31<00:08,  1.39s/it]Training:  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎          | 114/119 [02:32<00:06,  1.40s/it]Training:  97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍        | 115/119 [02:34<00:05,  1.39s/it]Training:  97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌      | 116/119 [02:35<00:04,  1.40s/it]Training:  98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋    | 117/119 [02:36<00:02,  1.37s/it]Training:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊  | 118/119 [02:38<00:01,  1.35s/it]Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 119/119 [02:39<00:00,  1.20s/it]Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 119/119 [02:39<00:00,  1.34s/it]
epoch0 training loss: 0.12705904627297104

epoch0 Learning Rate: 0.0001

Validating:   0%|                                                                                                                                                                                                                                                                       | 0/34 [00:00<?, ?it/s]Validating:   3%|███████▌                                                                                                                                                                                                                                                       | 1/34 [00:00<00:30,  1.07it/s]Validating:   3%|███████▌                                                                                                                                                                                                                                                       | 1/34 [00:01<01:03,  1.93s/it]
Traceback (most recent call last):
  File "/root/shared-nvme/onion/cnn_model/run_command/../common_train.py", line 366, in <module>
    tmp_runner(dataset=args.dataset,
  File "/root/shared-nvme/onion/cnn_model/run_command/../common_train.py", line 336, in tmp_runner
    run(Module, config)
  File "/root/shared-nvme/onion/cnn_model/run_command/../common_train.py", line 234, in run
    train_losses, val_losses = train(onion, train_loader, val_loader, config)
  File "/root/shared-nvme/onion/cnn_model/run_command/../common_train.py", line 137, in train
    pred = model(input, posi)
  File "/root/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/shared-nvme/onion/cnn_model/onion_model.py", line 424, in forward
    conv_pi = self.net2(pi)
  File "/root/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/.local/lib/python3.10/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
  File "/root/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/.local/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/root/.local/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 674.00 MiB. GPU 0 has a total capacity of 23.64 GiB of which 422.81 MiB is free. Process 3867126 has 23.22 GiB memory in use. Of the allocated memory 22.02 GiB is allocated by PyTorch, and 759.79 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
An error occurred while running the command. Aborting.
